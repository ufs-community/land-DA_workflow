<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>2.1. Land DA Workflow (Hera &amp; Orion) &mdash; UFS Offline Land DA User&#39;s Guide develop documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=044582d4" />
      <link rel="stylesheet" type="text/css" href="../_static/theme_overrides.css?v=3db8afb0" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=16816911"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="2.2. Containerized Land DA Workflow" href="Container.html" />
    <link rel="prev" title="2. Building, Running, and Testing the Land DA System" href="index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            UFS Offline Land DA User's Guide
              <img src="https://github.com/ufs-community/ufs/wiki/images/ufs-epic-logo.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                develop
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../BackgroundInfo/index.html">1. Background Information</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">2. Building, Running, and Testing the Land DA System</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">2.1. Land DA Workflow (Hera &amp; Orion)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#create-a-working-directory">2.1.1. Create a Working Directory</a></li>
<li class="toctree-l3"><a class="reference internal" href="#get-code">2.1.2. Get Code</a></li>
<li class="toctree-l3"><a class="reference internal" href="#build-the-land-da-system">2.1.3. Build the Land DA System</a></li>
<li class="toctree-l3"><a class="reference internal" href="#configure-an-experiment">2.1.4. Configure an Experiment</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#load-the-workflow-environment">2.1.4.1. Load the Workflow Environment</a></li>
<li class="toctree-l4"><a class="reference internal" href="#modify-the-workflow-configuration-yaml">2.1.4.2. Modify the Workflow Configuration YAML</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#data">2.1.4.2.1. Data</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="#generate-the-rocoto-xml-file">2.1.4.3. Generate the Rocoto XML File</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#run-the-experiment">2.1.5. Run the Experiment</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#workflow-overview">2.1.5.1. Workflow Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="#run-with-rocoto">2.1.5.2. Run With Rocoto</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#automated-run">2.1.5.2.1. Automated Run</a></li>
<li class="toctree-l5"><a class="reference internal" href="#manual-submission">2.1.5.2.2. Manual Submission</a></li>
<li class="toctree-l5"><a class="reference internal" href="#track-experiment-status">2.1.5.2.3. Track Experiment Status</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="#check-experiment-output">2.1.5.3. Check Experiment Output</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#plotting-results">2.1.5.3.1. Plotting Results</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Container.html">2.2. Containerized Land DA Workflow</a></li>
<li class="toctree-l2"><a class="reference internal" href="TestingLandDA.html">2.3. Testing the Land DA Workflow</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../CustomizingTheWorkflow/index.html">3. Customizing the Workflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Reference/index.html">4. Reference</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">UFS Offline Land DA User's Guide</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html"><span class="section-number">2. </span>Building, Running, and Testing the Land DA System</a></li>
      <li class="breadcrumb-item active"><span class="section-number">2.1. </span>Land DA Workflow (Hera &amp; Orion)</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/BuildingRunningTesting/BuildRunLandDA.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="land-da-workflow-hera-orion">
<span id="buildrunlandda"></span><h1><span class="section-number">2.1. </span>Land DA Workflow (Hera &amp; Orion)<a class="headerlink" href="#land-da-workflow-hera-orion" title="Link to this heading"></a></h1>
<p>This chapter provides instructions for building and running basic Land DA cases for the Unified Forecast System (<a class="reference internal" href="../Reference/Glossary.html#term-UFS"><span class="xref std std-term">UFS</span></a>) Land DA System using a Jan. 3-4, 2000 00z sample case using <a class="reference internal" href="../Reference/Glossary.html#term-GSWP3"><span class="xref std std-term">GSWP3</span></a> data with the UFS Noah-MP land component.</p>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>These steps are designed for use on <a class="reference internal" href="../BackgroundInfo/TechnicalOverview.html#levelsofsupport"><span class="std std-ref">Level 1</span></a> systems (i.e., Hera and Orion) and may require significant changes on other systems. It is recommended that users on other systems run the containerized version of Land DA. Users may reference <a class="reference internal" href="Container.html#container"><span class="std std-numref">Chapter 2.2: Containerized Land DA Workflow</span></a> for instructions.</p>
</div>
<section id="create-a-working-directory">
<span id="create-dir"></span><h2><span class="section-number">2.1.1. </span>Create a Working Directory<a class="headerlink" href="#create-a-working-directory" title="Link to this heading"></a></h2>
<p>Users can either create a new directory for their Land DA work or choose an existing directory, depending on preference. Then, users should navigate to this directory. For example, to create a new directory and navigate to it, run:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">mkdir /path/to/landda</span>
<span class="go">cd /path/to/landda</span>
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">/path/to/landda</span></code> is the path to the directory where the user plans to run Land DA experiments. In the experiment configuration file, this directory is referred to as <code class="docutils literal notranslate"><span class="pre">$EXP_BASEDIR</span></code>.</p>
<p>Optionally, users can save this directory path in an environment variable (e.g., <code class="docutils literal notranslate"><span class="pre">$LANDDAROOT</span></code>) to avoid typing out full path names later.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">export LANDDAROOT=`pwd`</span>
</pre></div>
</div>
<p>In this documentation, <code class="docutils literal notranslate"><span class="pre">$LANDDAROOT</span></code> is used, but users are welcome to choose another name for this variable if they prefer.</p>
</section>
<section id="get-code">
<span id="getcode"></span><h2><span class="section-number">2.1.2. </span>Get Code<a class="headerlink" href="#get-code" title="Link to this heading"></a></h2>
<p>Clone the Land DA workflow repository. To clone the <code class="docutils literal notranslate"><span class="pre">develop</span></code> branch, run:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">git clone -b develop --recursive https://github.com/ufs-community/land-DA_workflow.git</span>
</pre></div>
</div>
<p>To clone the most recent release, run the same command with <code class="docutils literal notranslate"><span class="pre">release/public-v1.2.0</span></code> in place of <code class="docutils literal notranslate"><span class="pre">develop</span></code>:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">git clone -b release/public-v1.2.0 --recursive https://github.com/ufs-community/land-DA_workflow.git</span>
</pre></div>
</div>
</section>
<section id="build-the-land-da-system">
<span id="build-land-da"></span><h2><span class="section-number">2.1.3. </span>Build the Land DA System<a class="headerlink" href="#build-the-land-da-system" title="Link to this heading"></a></h2>
<ol class="arabic">
<li><p>Navigate to the <code class="docutils literal notranslate"><span class="pre">sorc</span></code> directory.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">cd $LANDDAROOT/land-DA_workflow/sorc</span>
</pre></div>
</div>
</li>
<li><p>Run the build script <code class="docutils literal notranslate"><span class="pre">app_build.sh</span></code>:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">./app_build.sh</span>
</pre></div>
</div>
<p>If the code successfully compiles, the console output should end with:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">[100%] Completed &#39;ufs_model.fd&#39;</span>
<span class="go">[100%] Built target ufs_model.fd</span>
<span class="go">... Moving pre-compiled executables to designated location ...</span>
</pre></div>
</div>
<p>Additionally, the <code class="docutils literal notranslate"><span class="pre">exec</span></code> directory will contain the following executables:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">apply_incr.exe</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ufsLand.exe</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">vector2tile_converter.exe</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tile2tile_converter.exe</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ufs_model</span></code></p></li>
</ul>
</div></blockquote>
</li>
</ol>
</section>
<section id="configure-an-experiment">
<span id="config-wflow"></span><h2><span class="section-number">2.1.4. </span>Configure an Experiment<a class="headerlink" href="#configure-an-experiment" title="Link to this heading"></a></h2>
<section id="load-the-workflow-environment">
<span id="load-env"></span><h3><span class="section-number">2.1.4.1. </span>Load the Workflow Environment<a class="headerlink" href="#load-the-workflow-environment" title="Link to this heading"></a></h3>
<p>To load the workflow environment, run:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">cd $LANDDAROOT/land-DA_workflow</span>
<span class="go">module use modulefiles</span>
<span class="go">module load wflow_&lt;platform&gt;</span>
<span class="go">conda activate land_da</span>
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">&lt;platform&gt;</span></code> is <code class="docutils literal notranslate"><span class="pre">hera</span></code> or <code class="docutils literal notranslate"><span class="pre">orion</span></code>. This activates the <code class="docutils literal notranslate"><span class="pre">land_da</span></code> conda environment, and the user typically sees <code class="docutils literal notranslate"><span class="pre">(land_da)</span></code> in front of the Terminal prompt at this point.</p>
</section>
<section id="modify-the-workflow-configuration-yaml">
<span id="configure-expt"></span><h3><span class="section-number">2.1.4.2. </span>Modify the Workflow Configuration YAML<a class="headerlink" href="#modify-the-workflow-configuration-yaml" title="Link to this heading"></a></h3>
<p>Copy the experiment settings into <code class="docutils literal notranslate"><span class="pre">land_analysis.yaml</span></code>:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">cd $LANDDAROOT/land-DA_workflow/parm</span>
<span class="go">cp land_analysis_&lt;platform&gt;.yaml land_analysis.yaml</span>
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">&lt;platform&gt;</span></code> is <code class="docutils literal notranslate"><span class="pre">hera</span></code> or <code class="docutils literal notranslate"><span class="pre">orion</span></code>.</p>
<p>Users will need to configure certain elements of their experiment in <code class="docutils literal notranslate"><span class="pre">land_analysis.yaml</span></code>:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">ACCOUNT:</span></code> A valid account name. Hera, Orion, and most NOAA RDHPCS systems require a valid account name; other systems may not (in which case, any value will do).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">EXP_BASEDIR:</span></code> The full path to the directory where land-DA_workflow was cloned (i.e., <code class="docutils literal notranslate"><span class="pre">$LANDDAROOT</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cycledef/spec:</span></code> Cycle specification</p></li>
</ul>
</div></blockquote>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To determine an appropriate <code class="docutils literal notranslate"><span class="pre">ACCOUNT</span></code> field for Level 1 systems that use the Slurm job scheduler, run <code class="docutils literal notranslate"><span class="pre">saccount_params</span></code>. On other systems, running <code class="docutils literal notranslate"><span class="pre">groups</span></code> will return a list of projects that the user has permissions for. Not all listed projects/groups have an HPC allocation, but those that do are potentially valid account names.</p>
</div>
<p>Users may configure other elements of an experiment in <code class="docutils literal notranslate"><span class="pre">land_analysis.yaml</span></code> if desired. The <code class="docutils literal notranslate"><span class="pre">land_analysis_*.yaml</span></code> files contain reasonable default values for running a Land DA experiment. Users who wish to run a more complex experiment may change the values in these files and the files they reference using information in Sections <a class="reference internal" href="../CustomizingTheWorkflow/ConfigWorkflow.html#configworkflow"><span class="std std-numref">3.1</span></a>, <a class="reference internal" href="../CustomizingTheWorkflow/Model.html#model"><span class="std std-numref">3.2</span></a>, and <a class="reference internal" href="../CustomizingTheWorkflow/DASystem.html#dasystem"><span class="std std-numref">3.3</span></a>.</p>
<section id="data">
<span id="getdata"></span><h4><span class="section-number">2.1.4.2.1. </span>Data<a class="headerlink" href="#data" title="Link to this heading"></a></h4>
<p><a class="reference internal" href="#level1data"><span class="std std-numref">Table 2.1</span></a> shows the locations of pre-staged data on NOAA <a class="reference internal" href="../Reference/Glossary.html#term-RDHPCS"><span class="xref std std-term">RDHPCS</span></a> (i.e., Hera and Orion). These data locations are already included in the <code class="docutils literal notranslate"><span class="pre">land_analysis_*.yaml</span></code> files but are provided here for informational purposes.</p>
<span id="level1data"></span><table class="docutils align-default" id="id1">
<caption><span class="caption-number">Table 2.1 </span><span class="caption-text">Level 1 RDHPCS Data</span><a class="headerlink" href="#id1" title="Link to this table"></a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Platform</p></th>
<th class="head"><p>Data Location</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Hera</p></td>
<td><p>/scratch2/NAGAPE/epic/UFS_Land-DA_Dev/inputs</p></td>
</tr>
<tr class="row-odd"><td><p>Orion</p></td>
<td><p>/work/noaa/epic/UFS_Land-DA_Dev/inputs</p></td>
</tr>
</tbody>
</table>
<p>Users who have difficulty accessing the data on Hera or Orion may download it according to the instructions in <a class="reference internal" href="Container.html#getdatac"><span class="std std-numref">Section 2.2.3</span></a>. Its subdirectories are soft-linked to the <code class="docutils literal notranslate"><span class="pre">fix</span></code> directory of <code class="docutils literal notranslate"><span class="pre">land-DA_workflow</span></code> by the build script <code class="docutils literal notranslate"><span class="pre">sorc/app_build.sh</span></code>.</p>
</section>
</section>
<section id="generate-the-rocoto-xml-file">
<span id="generate-wflow"></span><h3><span class="section-number">2.1.4.3. </span>Generate the Rocoto XML File<a class="headerlink" href="#generate-the-rocoto-xml-file" title="Link to this heading"></a></h3>
<p>Generate the workflow XML file with <code class="docutils literal notranslate"><span class="pre">uwtools</span></code> by running:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">uw rocoto realize --input-file land_analysis.yaml --output-file land_analysis.xml</span>
</pre></div>
</div>
<p>If the command runs without problems, <code class="docutils literal notranslate"><span class="pre">uwtools</span></code> will output a “0 errors found” message similar to the following:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">[2024-03-01T20:36:03]     INFO 0 UW schema-validation errors found</span>
<span class="go">[2024-03-01T20:36:03]     INFO 0 Rocoto validation errors found</span>
</pre></div>
</div>
<p>The generated workflow XML file (<code class="docutils literal notranslate"><span class="pre">land_analysis.xml</span></code>) will be used by the Rocoto workflow manager to determine which tasks (or “jobs”) to submit to the batch system and when to submit them (e.g., when task dependencies are satisfied).</p>
</section>
</section>
<section id="run-the-experiment">
<h2><span class="section-number">2.1.5. </span>Run the Experiment<a class="headerlink" href="#run-the-experiment" title="Link to this heading"></a></h2>
<section id="workflow-overview">
<span id="wflow-overview"></span><h3><span class="section-number">2.1.5.1. </span>Workflow Overview<a class="headerlink" href="#workflow-overview" title="Link to this heading"></a></h3>
<p>Each Land DA experiment includes multiple tasks that must be run in order to satisfy the dependencies of later tasks. These tasks are housed in the <a class="reference internal" href="../Reference/Glossary.html#term-J-jobs"><span class="xref std std-term">J-job</span></a> scripts contained in the <code class="docutils literal notranslate"><span class="pre">jobs</span></code> directory.</p>
<span id="workflowtaskstable"></span><table class="docutils align-default" id="id2">
<caption><span class="caption-number">Table 2.2 </span><span class="caption-text"><em>J-job Tasks in the Land DA Workflow</em></span><a class="headerlink" href="#id2" title="Link to this table"></a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>J-job Task</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>JLANDDA_PREP_OBS</p></td>
<td><p>Sets up the observation data files</p></td>
</tr>
<tr class="row-odd"><td><p>JLANDDA_PRE_ANAL</p></td>
<td><p>Transfers the snow data from the restart files to the surface data files</p></td>
</tr>
<tr class="row-even"><td><p>JLANDDA_ANALYSIS</p></td>
<td><p>Runs <a class="reference internal" href="../Reference/Glossary.html#term-JEDI"><span class="xref std std-term">JEDI</span></a> and adds the increment to the surface data files</p></td>
</tr>
<tr class="row-odd"><td><p>JLANDDA_POST_ANAL</p></td>
<td><p>Transfers the JEDI result from the surface data files to the restart files</p></td>
</tr>
<tr class="row-even"><td><p>JLANDDA_PLOT_STATS</p></td>
<td><p>Plots the JEDI result (scatter/histogram)</p></td>
</tr>
<tr class="row-odd"><td><p>JLANDDA_FORECAST</p></td>
<td><p>Runs the forecast model</p></td>
</tr>
</tbody>
</table>
<p>Users may run these tasks <a class="reference internal" href="#run-w-rocoto"><span class="std std-ref">using the Rocoto workflow manager</span></a>.</p>
</section>
<section id="run-with-rocoto">
<span id="run-w-rocoto"></span><h3><span class="section-number">2.1.5.2. </span>Run With Rocoto<a class="headerlink" href="#run-with-rocoto" title="Link to this heading"></a></h3>
<p>To run the experiment, users can automate job submission via <a class="reference internal" href="../Reference/Glossary.html#term-crontab"><span class="xref std std-term">crontab</span></a> or submit tasks manually via <code class="docutils literal notranslate"><span class="pre">rocotorun</span></code>.</p>
<section id="automated-run">
<h4><span class="section-number">2.1.5.2.1. </span>Automated Run<a class="headerlink" href="#automated-run" title="Link to this heading"></a></h4>
<p>To automate task submission, users must be on a system where <a class="reference internal" href="../Reference/Glossary.html#term-cron"><span class="xref std std-term">cron</span></a> is available. On Orion, cron is only available on the orion-login-1 node, so users will need to work on that node when running cron jobs on Orion.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">cd parm</span>
<span class="go">./launch_rocoto_wflow.sh add</span>
</pre></div>
</div>
<p>To check the status of the experiment, see <a class="reference internal" href="#verifysuccess"><span class="std std-numref">Section 2.1.5.2.3</span></a> on tracking experiment progress.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If users run into issues with the launch script, they can run <code class="docutils literal notranslate"><span class="pre">conda</span> <span class="pre">deactivate</span></code> before running the launch script.</p>
</div>
</section>
<section id="manual-submission">
<h4><span class="section-number">2.1.5.2.2. </span>Manual Submission<a class="headerlink" href="#manual-submission" title="Link to this heading"></a></h4>
<p>To run the experiment, issue a <code class="docutils literal notranslate"><span class="pre">rocotorun</span></code> command from the <code class="docutils literal notranslate"><span class="pre">parm</span></code> directory:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">rocotorun -w land_analysis.xml -d land_analysis.db</span>
</pre></div>
</div>
<p>Users will need to issue the <code class="docutils literal notranslate"><span class="pre">rocotorun</span></code> command multiple times. The tasks must be run in order, and <code class="docutils literal notranslate"><span class="pre">rocotorun</span></code> initiates the next task once its dependencies have completed successfully. Details on checking experiment status are provided in the <a class="reference internal" href="#verifysuccess"><span class="std std-ref">next section</span></a>.</p>
</section>
<section id="track-experiment-status">
<span id="verifysuccess"></span><h4><span class="section-number">2.1.5.2.3. </span>Track Experiment Status<a class="headerlink" href="#track-experiment-status" title="Link to this heading"></a></h4>
<p>To view the experiment status, run:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">rocotostat -w land_analysis.xml -d land_analysis.db</span>
</pre></div>
</div>
<p>If <code class="docutils literal notranslate"><span class="pre">rocotorun</span></code> was successful, the <code class="docutils literal notranslate"><span class="pre">rocotostat</span></code> command will print a status report to the console. For example:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">CYCLE                TASK                       JOBID        STATE   EXIT STATUS   TRIES   DURATION</span>
<span class="go">=========================================================================================================</span>
<span class="go">200001030000     prep_obs                    61746064       QUEUED             -       1        0.0</span>
<span class="go">200001030000     pre_anal   druby://10.184.3.62:41973   SUBMITTING             -       1        0.0</span>
<span class="go">200001030000     analysis                           -            -             -       -          -</span>
<span class="go">200001030000    post_anal                           -            -             -       -          -</span>
<span class="go">200001030000   plot_stats                           -            -             -       -          -</span>
<span class="go">200001030000     forecast                           -            -             -       -          -</span>
<span class="go">=========================================================================================================</span>
<span class="go">200001040000     prep_obs   druby://10.184.3.62:41973   SUBMITTING             -       1        0.0</span>
<span class="go">200001040000     pre_anal                           -            -             -       -          -</span>
<span class="go">200001040000     analysis                           -            -             -       -          -</span>
<span class="go">200001040000    post_anal                           -            -             -       -          -</span>
<span class="go">200001040000   plot_stats                           -            -             -       -          -</span>
<span class="go">200001040000     forecast                           -            -             -       -          -</span>
</pre></div>
</div>
<p>Note that the status table printed by <code class="docutils literal notranslate"><span class="pre">rocotostat</span></code> only updates after each <code class="docutils literal notranslate"><span class="pre">rocotorun</span></code> command (whether issued manually or via cron automation). For each task, a log file is generated. These files are stored in <code class="docutils literal notranslate"><span class="pre">$LANDDAROOT/ptmp/test/com/output/logs/run_&lt;forcing&gt;</span></code>, where <code class="docutils literal notranslate"><span class="pre">&lt;forcing&gt;</span></code> is either <code class="docutils literal notranslate"><span class="pre">gswp3</span></code> or <code class="docutils literal notranslate"><span class="pre">era5</span></code>.</p>
<p>The experiment has successfully completed when all tasks say SUCCEEDED under STATE. Other potential statuses are: QUEUED, SUBMITTING, RUNNING, and DEAD. Users may view the log files to determine why a task may have failed.</p>
</section>
</section>
<section id="check-experiment-output">
<span id="check-output"></span><h3><span class="section-number">2.1.5.3. </span>Check Experiment Output<a class="headerlink" href="#check-experiment-output" title="Link to this heading"></a></h3>
<p>As the experiment progresses, it will generate a number of directories to hold intermediate and output files. The structure of those files and directories appears below:</p>
<div class="highlight-console notranslate" id="land-da-dir-structure"><div class="highlight"><pre><span></span><span class="gp">$</span>LANDDAROOT:<span class="w"> </span>Base<span class="w"> </span>directory
<span class="go"> ├── land-DA_workflow(&lt;CYCLEDIR&gt;): Home directory of the land DA workflow</span>
<span class="go"> └── ptmp (&lt;PTMP&gt;)</span>
<span class="go">       └── test (&lt;envir&gt; or &lt;OPSROOT&gt;)</span>
<span class="go">             └── com (&lt;COMROOT&gt;)</span>
<span class="go">             │     ├── landda (&lt;NET&gt;)</span>
<span class="go">             │     │     └── vX.Y.Z (&lt;model_ver&gt;)</span>
<span class="go">             │     │           └── landda.YYYYMMDD (&lt;RUN&gt;.&lt;PDY&gt;): Directory containing the output files</span>
<span class="go">             │     │                 ├── hofx</span>
<span class="go">             │     │                 └── plot</span>
<span class="go">             │     └── output</span>
<span class="go">             │           └── logs (&lt;LOGDIR&gt;): Directory containing the log files for the Rocoto workflow</span>
<span class="go">             └── tmp (&lt;DATAROOT&gt;)</span>
<span class="go">                  ├── &lt;jobid&gt; (&lt;DATA&gt;): Working directory</span>
<span class="go">                  └── DATA_SHARE</span>
<span class="go">                        ├── YYYYMMDD (&lt;PDY&gt;): Directory containing the intermediate or temporary files</span>
<span class="go">                        ├── hofx: Directory containing the soft links to the results of the analysis task for plotting</span>
<span class="go">                        └── DATA_RESTART: Directory containing the soft links to the restart files for the next cycles</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">&lt;forcing&gt;</span></code> refers to the type of forcing data used (<code class="docutils literal notranslate"><span class="pre">gswp3</span></code> or <code class="docutils literal notranslate"><span class="pre">era5</span></code>). Each variable in parentheses and angle brackets (e.g., <code class="docutils literal notranslate"><span class="pre">(&lt;VAR&gt;)</span></code>) is the name for the directory defined in the file <code class="docutils literal notranslate"><span class="pre">land_analysis.yaml</span></code>. In the future, this directory structure will be further modified to meet the <a class="reference external" href="https://www.nco.ncep.noaa.gov/idsb/implementation_standards/">NCO Implementation Standards</a>.</p>
<p>Check for the output files for each cycle in the experiment directory:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">ls -l $LANDDAROOT/ptmp/test/com/landda/&lt;model_ver&gt;/landda.YYYYMMDD</span>
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">YYYYMMDD</span></code> is the cycle date, and <code class="docutils literal notranslate"><span class="pre">&lt;model_ver&gt;</span></code> is the model version (currently <code class="docutils literal notranslate"><span class="pre">v1.2.1</span></code> in the <code class="docutils literal notranslate"><span class="pre">develop</span></code> branch). The experiment should generate several restart files.</p>
<section id="plotting-results">
<span id="plotting"></span><h4><span class="section-number">2.1.5.3.1. </span>Plotting Results<a class="headerlink" href="#plotting-results" title="Link to this heading"></a></h4>
<p>Additionally, in the <code class="docutils literal notranslate"><span class="pre">plot</span></code> subdirectory, users will find images depicting the results of the <code class="docutils literal notranslate"><span class="pre">analysis</span></code> task for each cycle as a scatter plot (<code class="docutils literal notranslate"><span class="pre">hofx_oma_YYYMMDD_scatter.png</span></code>) and as a histogram (<code class="docutils literal notranslate"><span class="pre">hofx_oma_YYYYMMDD_histogram.png</span></code>).</p>
<p>The scatter plot is named OBS-ANA (i.e., Observation Minus Analysis [OMA]), and it depicts a map of snow depth results. Blue points indicate locations where the observed values are less than the analysis values, and red points indicate locations where the observed values are greater than the analysis values. The title lists the mean and standard deviation of the absolute value of the OMA values.</p>
<p>The histogram plots OMA values on the x-axis and frequency density values on the y-axis. The title of the histogram lists the mean and standard deviation of the real value of the OMA values.</p>
<span id="sample-plots"></span><table class="docutils align-default" id="id3">
<caption><span class="caption-number">Table 2.3 </span><span class="caption-text">Snow Depth Plots for 2000-01-04</span><a class="headerlink" href="#id3" title="Link to this table"></a></caption>
<tbody>
<tr class="row-odd"><td><p><img alt="Map of snow depth in millimeters (observation minus analysis)" src="https://raw.githubusercontent.com/wiki/ufs-community/land-DA_workflow/images/LandDAScatterPlot.png" /></p></td>
<td><p><img alt="Histogram of snow depth in millimeters (observation minus analysis) on the x-axis and frequency density on the y-axis" src="https://raw.githubusercontent.com/wiki/ufs-community/land-DA_workflow/images/LandDAHistogram.png" /></p></td>
</tr>
</tbody>
</table>
</section>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="2. Building, Running, and Testing the Land DA System" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="Container.html" class="btn btn-neutral float-right" title="2.2. Containerized Land DA Workflow" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, .</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>